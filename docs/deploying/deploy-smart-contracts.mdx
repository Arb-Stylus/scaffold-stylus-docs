---
sidebar_position: 1
---

# Deploy Your Stylus Smart Contracts

To deploy your Stylus smart contracts to Arbitrum networks, there are a few things you need to adjust.

## 1. Configure your network

Scaffold-Stylus supports Arbitrum networks by default. You can configure your deployment network using environment variables.

### Local Network Setup

For local development, you need to start a local Stylus-compatible network first:

```bash
yarn chain
```

This command starts a local Stylus-compatible network using the Nitro dev node script (`./packages/stylus/nitro-devnode/run-dev-node.sh`). The network runs on your local machine and can be used for testing and development. You can customize the Nitro dev node configuration in the `nitro-devnode` submodule.

### Using Network Names

Instead of setting `RPC_URL` manually, you can use the `NETWORK` environment variable:

```bash
# Deploy to Arbitrum One (mainnet)
NETWORK=arbitrum yarn deploy
NETWORK=mainnet yarn deploy  # alias for arbitrum

# Deploy to Arbitrum Sepolia testnet
NETWORK=arbitrumSepolia yarn deploy
NETWORK=testnet yarn deploy  # alias for arbitrumSepolia
```

### Available Networks

This template supports Arbitrum networks only. You can test which networks are available and their RPC URLs:

```bash
yarn test:networks
```

This will show you all supported networks and their corresponding RPC endpoints.

### Fallback Behavior

If a network name is not supported (only `arbitrum`, `arbitrumSepolia`, `mainnet`, and `testnet` are supported), the system will:

1. Show a warning message indicating the network isn't supported
2. Fall back to the `RPC_URL` environment variable (or default to `http://localhost:8547`)
3. Continue with deployment using the fallback endpoint

### Environment Variables

You can still use the traditional approach with `RPC_URL`:

```bash
RPC_URL=https://your-custom-rpc.com yarn deploy
```

Or combine both (network takes precedence):

```bash
NETWORK=mainnet RPC_URL=https://fallback-rpc.com yarn deploy
```

For testnet information, including faucets and RPC endpoints, see the [Arbitrum Stylus testnet documentation](https://docs.arbitrum.io/stylus/reference/testnet-information).

## 2. Deploy your Stylus smart contract(s)

### Deploy to Local Network

The simplest way to deploy your Stylus smart contract is using:

```bash
yarn deploy
```

This command deploys a test smart contract to the local network. The contract is located in `packages/stylus/src` and can be modified to suit your needs. The `yarn deploy` command uses the deploy script located in `packages/stylus/scripts` to deploy the contract to the network. You can also customize the deploy script.

### Check Your Program

Before deploying to live networks, you can check that your program compiles to valid WASM for Stylus and will succeed a deployment onchain without transacting:

```bash
cargo stylus check
```

If successful, you should see:

```bash
Finished release [optimized] target(s) in 1.88s
Reading WASM file at target/wasm32-unknown-unknown/release/your-program.wasm
Compressed WASM size: 8.9 KB
Program succeeded Stylus onchain activation checks with Stylus version: 1
```

### Deploy to Live Networks

To deploy your Stylus program to live networks, you'll need a private key file:

```bash
cargo stylus deploy \
  --private-key-path=<PRIVKEY_FILE_PATH>
```

The CLI will send 2 transactions to deploy and activate your program onchain:

```bash
Compressed WASM size: 8.9 KB
Deploying program to address 0x457b1ba688e9854bdbed2f473f7510c476a3da09
Estimated gas: 1973450
Submitting tx...
Confirmed tx 0x42db…7311, gas used 1973450
Activating program at address 0x457b1ba688e9854bdbed2f473f7510c476a3da09
Estimated gas: 14044638
Submitting tx...
Confirmed tx 0x0bdb…3307, gas used 14044638
```

Once both steps are successful, you can interact with your program as you would with any Ethereum smart contract.

### Estimate Gas Costs

You can estimate the gas costs to deploy and activate your program before sending the transaction:

```bash
cargo stylus deploy \
  --private-key-path=<PRIVKEY_FILE_PATH> \
  --estimate-gas
```

You will then see the estimated gas cost for deploying:

```bash
Deploying program to address e43a32b54e48c7ec0d3d9ed2d628783c23d65020
Estimated gas for deployment: 1874876
```

:::info Note
The above only estimates gas for the deployment tx by default. To estimate gas for activation, first deploy your program using `--mode=deploy-only`, and then run `cargo stylus deploy` with the `--estimate-gas` flag, `--mode=activate-only`, and specify `--activate-program-address`.
:::

:::info Note
You can edit your deployment scripts in `packages/stylus/scripts` to customize the deployment process.
:::

## 3. Export ABI for your smart contract

If you are using `yarn deploy`, the script will automatically export the ABI to `packages/nextjs/contracts/deployedContracts.ts`. You can manually export the ABI for your Stylus program by using:

```bash
yarn export-abi
```

This outputs a Solidity interface that represents your Rust program:

```js
/**
 * This file was automatically generated by Stylus and represents a Rust program.
 * For more information, please see [The Stylus SDK](https://github.com/OffchainLabs/stylus-sdk-rs).
 */

// SPDX-License-Identifier: MIT-OR-APACHE-2.0
pragma solidity ^0.8.23;

interface ICounter {
    function number() external view returns (uint256);
    function setNumber(uint256 new_number) external;
    function increment() external;
}
```

Exporting ABIs uses a feature that is enabled by default in your `Cargo.toml`:

```toml
[features]
export-abi = ["stylus-sdk/export-abi"]
```

## 4. Deploy to Other Chains

To deploy your contracts to a different network (other than the default local Nitro dev node), you need to update a few configuration options:

### 1. Set the RPC URL

Specify the target network's RPC endpoint in the `RPC_URL` environment variable. You can do this in your shell or by creating a `.env` file (see `.env.example` for reference).

```env
RPC_URL=https://your-network-rpc-url
```

### 2. Set the Private Key

If you want to deploy using your own wallet, set the `PRIVATE_KEY` environment variable to your wallet's private key. By default, a development key is used when running the Nitro dev node locally, but for real deployments you must provide your own.

```env
PRIVATE_KEY=your_private_key_here
```

### 3. Update the Target Chain in the Frontend

Open `packages/nextjs/scaffold.config.ts` and change the `targetNetworks` array to include the correct chain for your deployment. This ensures the frontend connects to the right network and that the ABI is generated correctly in `deployedContracts.ts`.

```ts
import { mainnet } from "viem/chains";
// ...
targetNetworks: [mainnet],
```

:::warning Important Notes

- The values in `.env.example` provide a template for the required environment variables.
- The chain specified in `scaffold.config.ts` is used to generate the ABI and populate `deployedContracts.ts` for your frontend.
- Always keep your private key secure and never commit it to version control.
  :::

### 4. Deploy to the Target Network

Once you've configured the network settings, you can deploy using:

```bash
yarn deploy
```

Or for more control over the deployment process:

```bash
cargo stylus deploy --private-key-path=<PRIVKEY_FILE_PATH>
```
